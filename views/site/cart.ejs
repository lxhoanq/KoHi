<% include layout/header.ejs %>
<section class="cart">
    <div class="container">
        <div class="cart-top-wrap">
            <div class="cart-top">
                <div class="cart-top-cart cart-top-item">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="cart-top-adress cart-top-item">
                    <i class="fas fa-map-marker-alt"></i>
                </div>
                <div class="cart-top-payment cart-top-item">
                    <i class="fas fa-money-check-alt"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <% if (cartItems.length > 0) { %>
        <div class="cart-content row">
            <div class="cart-content-left">
                <table>
                    <tr>
                        <th>Sản phẩm</th>
                        <th>Tên sản phẩm</th>
                        <th>Màu</th>
                        <th>Size</th>
                        <th>SL</th>
                        <th>Giá</th>
                        <th>Xóa</th>
                    </tr>
                    <% cartItems.forEach(item => { %>
                    <tr>
                        <td><img src="<%= item.sanpham_anh %>" alt=""></td>
                        <td><p><%= item.sanpham_tieude %></p></td>
                        <td><img src="<%= item.color_anh %>" alt=""></td>
                        <td><p><%= item.sanpham_size %></p></td>
                        <td><span><%= item.quantitys %></span></td>
                        <td><p><%= parseInt(item.sanpham_gia.replace(/\D/g, '')).toLocaleString('vi-VN') %><sup>đ</sup></p></td>
                        <td><a href="/cart/delete/<%= item.cart_id %>"><span>x</span></a></td>
                    </tr>
                    <% }) %>
                </table>
            </div>
            <div class="cart-content-right">
                <table>
                    <tr>
                        <th colspan="2"><p>TỔNG TIỀN GIỎ HÀNG</p></th>
                    </tr>
                    <tr>
                        <td>TỔNG SẢN PHẨM</td>
                        <td><%= SL %></td>
                    </tr>
                    <tr>
                        <td>TỔNG TIỀN HÀNG</td>
                        <td><p><%= TT.toLocaleString('vi-VN') %><sup>đ</sup></p></td>
                    </tr>
                    <tr>
                        <td>THÀNH TIỀN</td>
                        <td><p><%= TT.toLocaleString('vi-VN') %><sup>đ</sup></p></td>
                    </tr>
                    <tr>
                        <td>TẠM TÍNH</td>
                        <td><p style="font-weight: bold; color: black;"><%= TT.toLocaleString('vi-VN') %><sup>đ</sup></p></td>
                    </tr>
                </table>
                <div class="cart-content-right-text">
                    <p>Bạn sẽ được miễn phí ship khi đơn hàng của bạn có tổng giá trị trên <%= freeShipThreshold.toLocaleString('vi-VN') %><sup>đ</sup></p><br>
                    <% if (TT >= freeShipThreshold) { %>
                    <p style="color: red;font-weight: bold;">Đơn hàng của bạn đủ điều kiện được <span style="font-size: 18px;">Free</span> ship</p>
                    <% } else { %>
                    <p style="color: red;font-weight: bold;">Mua thêm <span style="font-size: 18px;"><%= (freeShipThreshold - TT).toLocaleString('vi-VN') %><sup>đ</sup></span> để được miễn phí SHIP</p>
                    <% } %>
                </div>
                <div class="cart-content-right-button">
                    <a href="/"><button>TIẾP TỤC MUA SẮM</button></a>
                    <a href="/delivery"><button>THANH TOÁN</button></a>
                </div>
            </div>
        </div>
        <% } else { %>
        <p>Bạn vẫn chưa thêm sản phẩm nào vào giỏ hàng, Vui lòng chọn sản phẩm nhé!</p>
        <% } %>
    </div>
</section>
<% include layout/footer.ejs %>
